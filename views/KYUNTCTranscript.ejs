<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link
      href="<%= studentData.appURL %>/documents/templates/KYU/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      html {
        -webkit-print-color-adjust: exact;
      }

      body {
        font-size: 9px;
        padding: 0;
        margin: 0;
        font-family: TimesNewRoman, 'Times New Roman', sans-serif;
        font-weight: 400;
        line-height: 1;
        color: #212529 !important;
      }

      @page {
        size: A4 portrait;
        margin: 20px 0;
      }

      .header h1 {
        font-size: 27.5px !important;
        line-height: 1.1;
        margin: 0;
      }

      .header h3 {
        font-size: 16px;
        font-weight: bolder;
        margin: 0;
        margin-bottom: 2px;
      }

      .header h4 {
        font-size: 15.5px !important;
        font-weight: bold;
        margin: 0;
      }

      .header h5 {
        font-size: 15px;
        line-height: 1;
        font-weight: bold;
        margin: 0;
      }

      .header h6 {
        font-size: 10px;
        font-weight: bolder;
        margin: 0;
      }

      .transcript-container {
        font-size: 10px;
        z-index: 1;
      }

      .table-title {
        width: 117px;
        font-weight: 500;
        letter-spacing: 0.5px;
      }

      .transcript-content {
        width: 100%;
        border: none;
        margin-top: 0.2rem;
        padding: 0.2rem;
        min-height: 74vh;
        background-image: url('<%= studentData.appURL %>/documents/templates/KYU/bg-logo.png');
        background-repeat: no-repeat;
        background-position: center;
        background-size: 600px 510px;
        z-index: 0.5;
        background-color: rgba(255, 255, 255, 0.61) !important;
      }

      .student-bio td {
        border: none !important;
        font-size: 10px;
        padding: 2px;
      }

      .documentTitle {
        background-color: #ff9822;
        font-size: 14px;
        padding: 2px;
        margin-bottom: 2px;
      }

      .profile-photo {
        /* width: 74px; */
        height: 74px;
      }

      .logo {
        width: 99px;
        margin-top: 1.5px;
      }

      .results {
        font-size: 8.5px !important;
      }

      .results table th {
        padding: 3px !important;
        font-weight: bold;
      }

      .results table td {
        padding-top: 2px;
        padding-bottom: 2px;
        line-height: 1;
        font-weight: normal;
        font-size: 9px !important;
      }

      .results .semester {
        color: #0d6efd;
        font-weight: normal;
        font-size: 10px;
      }

      .results .academic-year-result {
        padding: 0 3px;
      }

      .footer {
        background-color: #ff9822;
      }

      .note-text div,
      .note div {
        padding: 2px !important;
        color: #2f3542;
      }

      .cgpa {
        background: transparent !important;
        color: #198754;
      }
      .signature {
        margin-top: -5em;
        margin-left: 13em;
      }
    </style>
  </head>
  <body class="px-3">
    <div class="header text-center mx-4 border-dark">
      <div class="d-flex align-items-end justify-content-center">
        <h1 class="fw-bold m-0">KYAMBOGO</h1>
        <img
          src="<%= studentData.appURL %>/documents/templates/KYU/logo.png"
          class="logo mb-1 mx-2"
          alt="Logo"
        />
        <h1 class="fw-bold m-0">UNIVERSITY</h1>
      </div>
      <h4>P. O. BOX 1 KYAMBOGO</h4>
      <h5 class="tel">Tel: 0414-286237/8/285037</h5>
      <h6>Email: arkyu@kyu.ac.ug, www.kyu.ac.ug</h6>
      <h3>Office of the Academic Registrar</h3>
    </div>

    <div class="transcript-container">
      <div class="transcript-content">
        <hr class="m-0" />
        <div class="documentTitle text-center text-white text-md my-1">
          <strong>ACADEMIC TRANSCRIPT</strong>
        </div>
        <hr class="m-0" />
        <div class="student-bio my-4">
          <div class="row g-0">
            <div class="col-6">
              <table class="table table-sm table-borderless m-0">
                <tbody>
                  <tr>
                    <td class="table-title fw-bold">Name:</td>
                    <td class="text-start"><%= studentData.name %></td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Sex:</td>
                    <td class="text-start"><%= studentData.sex %></td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Nationality:</td>
                    <td class="text-start"><%= studentData.nationality %></td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Faculty:</td>
                    <td class="text-start">
                      <%= studentData.faculty.faculty_title %>
                    </td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Type of Entry:</td>
                    <td class="text-start">
                      <%= studentData.typeOfEntry.metadata_value %>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="col-6">
              <table class="table table-sm table-borderless m-0">
                <tbody>
                  <tr>
                    <td class="table-title fw-bold" style="width: 90px">
                      Registration Number:
                    </td>
                    <td class="text-start">
                      <%= studentData.registration_number %>
                    </td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Date of Birth:</td>
                    <td class="text-start"><%= studentData.date_of_birth %></td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Year of Entry:</td>
                    <td class="text-start"><%= studentData.year_of_entry %></td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Year of Completion:</td>
                    <td class="text-start">
                      <%= studentData.year_of_completion %>
                    </td>
                  </tr>
                  <tr>
                    <td class="table-title fw-bold">Programme:</td>
                    <td class="text-start">
                      <%= studentData.programme_code %>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="results mt-1">
          <div class="academic-year-result mb-1">
            <div class="row g-1">
              <% studentData.studyYears.forEach((studyYear) => {%>
              <div class="col-6">
                <table class="table table-sm table-borderless w-100m-0">
                  <thead>
                    <tr>
                      <th class="fw-bold py-3">
                        <span>
                          <%= `${studyYear.study_year}: ${studyYear.exam_date}`
                          %>
                        </span>
                      </th>
                      <th class="py-3">Grade</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% Object.keys(studyYear.categories).forEach((category) => {
                    %>
                    <tr>
                      <td class="fw-bold"><%= category %></td>
                    </tr>
                    <% studyYear.categories[category].forEach((result) => { %>
                    <tr>
                      <td width="80%">
                        <%= result['subject.ntc_subject_code'] %> <%=
                        result['subject.ntc_subject_title'] %>
                      </td>
                      <td><%= result['gradingValue.grading_letter'] %></td>
                    </tr>
                    <% }); %> <% }); %>
                  </tbody>
                </table>
              </div>
              <% }); %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-3 mb-2">
      <div class="row g-0">
        <div class="col-6">
          <table class="table mt-3 mb-0 table-borderless table-sm m-0">
            <tbody>
              <tr>
                <td class="fw-bold">Class:</td>
                <td><%= studentData.className %></td>
              </tr>
              <tr>
                <td></td>
              </tr>
              <tr>
                <td class="fw-bold">Award:</td>
                <td><%= studentData.programme_title %></td>
              </tr>
              <tr>
                <td colspan="3">
                  <strong class="text-sm"
                    >Please turn over for key to grading.</strong
                  >
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-6">
          <table class="table mt-3 mb-0 table-borderless table-sm m-0">
            <tbody>
              <tr>
                <td>
                  <div class="fw-bold">
                    Signed :
                    _________________________________________________________________
                  </div>
                  <img
                    src="<%= studentData.appURL %>/documents/templates/KYU/AR-sign-01.png"
                    alt="AR-SIGN"
                    class="signature text-center"
                    width="120"
                  />
                  <div class="text-center fw-bold" style="margin-top: -1em">
                    <strong> <small>Academic Registrar</small></strong>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="fw-bold">
                  Date &amp; Stamp:
                  __________________________________________________________
                </td>
              </tr>
              <tr>
                <td>
                  <strong class="text-sm">
                    Any alteration whatsoever renders this Transcript invalid.
                  </strong>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="footer fw-bold p-1">
        <div class="row g-1">
          <div class="col-1 text-end text-white note">
            <div class="text-white">NOTE:</div>
          </div>
          <div class="col-11 note-text">
            <div>
              1. The transcript is not valid without the Official Stamp of
              Kyambogo University
            </div>
            <div>2. The Medium of Instruction is English(UK)</div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
